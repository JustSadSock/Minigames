<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=1" />
  <meta name="theme-color" content="#1b1b1b" />
  <title>SadSock’s Minigames</title>
  <style>
    :root{
      --bg:#101014; --panel:#1a1a22; --panel-2:#232330;
      --ink:#e5e5f0; --muted:#a9a9c2; --accent:#61ffa8; --accent-2:#7af7ff;
      --px:1px; --safe-top: env(safe-area-inset-top); --safe-bottom: env(safe-area-inset-bottom);
      --safe-left: env(safe-area-inset-left); --safe-right: env(safe-area-inset-right);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    html{background:var(--bg)}
    body{
      margin:0;color:var(--ink);
      font-family:ui-monospace,"Cascadia Mono","Fira Code",Consolas,monospace;
      image-rendering:pixelated; -webkit-font-smoothing:none;
      overflow:hidden; /* без системных скроллов */
    }
    /* Layout */
    .app{position:relative;min-height:100dvh;
      padding-top:max(52px,calc(52px + var(--safe-top)));
      padding-bottom:max(8px,var(--safe-bottom));
      padding-left:max(0px,var(--safe-left));
      padding-right:max(0px,var(--safe-right));
    }
    .bg{position:fixed;inset:0;width:100%;height:100%;z-index:0;
      filter:contrast(120%) saturate(110%) brightness(110%);
      image-rendering:pixelated}
    /* Topbar */
    .topbar{position:fixed;top:0;left:0;right:0;z-index:10;
      padding:calc(8px + var(--safe-top)) 8px 8px 8px;
      display:flex;align-items:center;justify-content:space-between;
      background:linear-gradient(#2a2a38,#1b1b26) padding-box;
      border-bottom:var(--px) solid #000;
      outline:var(--px) solid #4a4a66; outline-offset:-1px}
    .brand{display:flex;align-items:center;gap:8px}
    .logo{width:20px;height:20px;
      background:linear-gradient(90deg,#7af7ff 0 50%,#61ffa8 50% 100%);
      box-shadow:0 0 0 var(--px) #000 inset,0 0 0 calc(var(--px)*2) #4a4a66 inset}
    .title{font-weight:700;letter-spacing:.5px;white-space:nowrap}
    .actions{display:flex;align-items:center;gap:8px}
    .btn{height:28px;padding:0 10px;cursor:pointer;color:var(--ink);
      background:#1a1a22;border:var(--px) solid #000;
      outline:var(--px) solid #4a4a66; outline-offset:-1px}
    .btn.icon{width:28px;padding:0;display:grid;place-items:center}
    .btn:active{transform:translateY(1px)}
    .ico{display:block;width:16px;height:16px;position:relative;image-rendering:pixelated}
    .ico-full::before{content:"";position:absolute;inset:2px;border:var(--px) solid var(--ink)}
    .ico-gear{background:radial-gradient(circle at 50% 50%,var(--ink) 30%,#0000 31%)}
    .ico-gear::before,.ico-gear::after{content:"";position:absolute;inset:0;
      background:conic-gradient(from 0deg,
        var(--ink) 0 6.25%,#0000 6.25% 12.5%,
        var(--ink) 12.5% 18.75%,#0000 18.75% 25%,
        var(--ink) 25% 31.25%,#0000 31.25% 37.5%,
        var(--ink) 37.5% 43.75%,#0000 43.75% 50%,
        var(--ink) 50% 56.25%,#0000 56.25% 62.5%,
        var(--ink) 62.5% 68.75%,#0000 68.75% 75%,
        var(--ink) 75% 81.25%,#0000 81.25% 87.5%,
        var(--ink) 87.5% 93.75%,#0000 93.75% 100%);
      mask:radial-gradient(circle at 50% 50%,#0000 0 35%,#000 36%);opacity:.9}
    .profile{display:flex;align-items:center;gap:8px;padding:2px 6px;
      background:#1a1a22;border:var(--px) solid #000;
      outline:var(--px) solid #4a4a66; outline-offset:-1px}
    .avatar{width:24px;height:24px;background:#0b0b10;border:var(--px) solid #000;
      outline:var(--px) solid #4a4a66; outline-offset:-1px; image-rendering:pixelated}
    .nick{color:#a9a9c2;font-weight:600}
    /* Content */
    .main{position:relative;z-index:1;padding:12px}
    .list-wrap{position:relative;overflow:hidden;
      height:calc(100dvh - 72px - max(8px,var(--safe-bottom)) - max(8px,var(--safe-top)));
      min-height:320px;display:grid;grid-template-columns:1fr 8px;
      background:#232330;border:var(--px) solid #000;
      outline:var(--px) solid #4a4a66; outline-offset:-1px}
    .list{position:relative;overflow:hidden;will-change:transform}
    .scrollbar{position:relative;background:#12121a;border-left:var(--px) solid #000}
    .thumb{position:absolute;left:0;width:100%;height:40px;top:0;
      background:linear-gradient(#61ffa8,#7af7ff);
      border:var(--px) solid #000; outline:var(--px) solid #4a4a66; outline-offset:-1px; cursor:grab}
    .item{display:grid;grid-template-columns:48px 1fr auto;gap:10px;align-items:center;
      padding:10px;border-bottom:var(--px) solid #000}
    .item:last-child{border-bottom:none}
    .icon-cell{width:48px;height:48px;
      background:repeating-linear-gradient(45deg,#0f1422 0 6px,#101a2c 6px 12px);
      border:var(--px) solid #000; outline:var(--px) solid #4a4a66; outline-offset:-1px}
    .item-title{font-weight:700}
    .item-desc{color:#a9a9c2;font-size:12px}
    .item-play .btn{background:linear-gradient(#1e2b2a,#142322);color:#61ffa8}
    .item-play .btn:hover{filter:brightness(1.1)}
    .footer{position:relative;z-index:1;margin:8px 12px 0 12px;padding:6px 8px;text-align:center;
      background:#1a1a22;border:var(--px) solid #000;outline:var(--px) solid #4a4a66; outline-offset:-1px;color:#a9a9c2}
    @media (max-width:640px){
      .item{grid-template-columns:40px 1fr auto;gap:8px;padding:8px}
      .icon-cell{width:40px;height:40px}
      .item-desc{display:none}
      .btn{height:26px;padding:0 8px}.btn.icon{width:26px}
      .topbar .title{max-width:40vw;overflow:hidden;text-overflow:ellipsis}
    }
  </style>
</head>
<body>
  <div class="app">
    <canvas id="bg" class="bg" aria-hidden="true"></canvas>
    <header class="topbar">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div class="title" title="SadSock’s Minigames">SadSock’s&nbsp;Minigames</div>
      </div>
      <div class="actions">
        <button id="btn-full" class="btn icon" title="Полноэкранный режим" aria-label="Полноэкранный режим"><span class="ico ico-full"></span></button>
        <button id="btn-settings" class="btn icon" title="Настройки" aria-label="Настройки"><span class="ico ico-gear"></span></button>
        <div class="profile">
          <canvas id="avatar" class="avatar" width="24" height="24" title="Профиль"></canvas>
          <span id="nickname" class="nick">@SadSock</span>
        </div>
      </div>
    </header>
    <main class="main">
      <div class="list-wrap">
        <div id="games" class="list" role="list"></div>
        <div id="scrollbar" class="scrollbar" aria-hidden="true"><div id="thumb" class="thumb"></div></div>
      </div>
    </main>
    <footer class="footer"><span>Have fun.</span></footer>
  </div>
  <script>
    // ——— Параметры ———
    const NICKNAME = "@SadSock";
    const GAMES = [
      {id:"pong",title:"Pong 8-bit",desc:"Классика на квадратиках",href:"#pong"},
      {id:"runner",title:"Runner 1-bit",desc:"Прыгай, чтобы не умереть",href:"#runner"},
      {id:"breakout",title:"Breakout 160p",desc:"Разноси блоки — живи",href:"#breakout"},
      {id:"rogue",title:"RogueGrid",desc:"Клеточки, боль, кайф",href:"#rogue"},
      {id:"tactics",title:"Micro Tactics",desc:"Тактика в пикселях",href:"#tactics"}
    ];
    // ——— DOM ———
    const bg=document.getElementById("bg"),
          gamesEl=document.getElementById("games"),
          bar=document.getElementById("scrollbar"),
          thumb=document.getElementById("thumb"),
          btnFull=document.getElementById("btn-full"),
          btnSettings=document.getElementById("btn-settings"),
          avatar=document.getElementById("avatar"),
          nickname=document.getElementById("nickname");
    nickname.textContent=NICKNAME;
    // ——— Фон в пикселях ———
    (function(){const c=bg.getContext("2d");let w,h,t=0,px=6;
      function rs(){w=bg.width=Math.ceil(innerWidth/px);h=bg.height=Math.ceil(innerHeight/px);c.imageSmoothingEnabled=false}
      addEventListener("resize",rs,{passive:true}); rs();
      (function loop(){
        for(let y=0;y<h;y++){for(let x=0;x<w;x++){
          const v=Math.sin((x*.15+t)*.25)+Math.cos((y*.13-t)*.22);
          const cc=12+Math.floor((v+2)*16);
          c.fillStyle=`rgb(${cc},${cc+8},${cc+16})`;
          c.fillRect(x,y,1,1);
        }} t+=.8; bg.style.width="100%"; bg.style.height="100%";
        requestAnimationFrame(loop);
      })();
    })();
    // ——— Пиксель-аватар (симметричный, с лёгкой анимацией) ———
    (function(){const c=avatar.getContext("2d"),S=24,CELL=3; c.imageSmoothingEnabled=false;
      function draw(t=0){c.clearRect(0,0,S,S);
        const cols=5,rows=6; const sx=((S/CELL)-cols)/2|0, sy=((S/CELL)-rows)/2|0;
        for(let y=0;y<rows;y++){
          const hue=(t*2+y*20)%360, col=`hsl(${hue},80%,70%)`;
          for(let x=0;x<Math.ceil(cols/2);x++){
            const v=((x*y+t)%3)!==0; if(!v) continue;
            c.fillStyle=col;
            c.fillRect((sx+x)*CELL,(sy+y)*CELL,CELL,CELL);
            const mx=(sx+(cols-1-x))*CELL;
            c.fillRect(mx,(sy+y)*CELL,CELL,CELL);
          }
        }
      }
      let k=0; setInterval(()=>draw(++k),140); draw();
    })();
    // ——— Рендер списка игр ———
    (function render(){const f=document.createDocumentFragment();
      GAMES.forEach(g=>{
        const el=document.createElement("div");
        el.className="item"; el.setAttribute("role","listitem");
        el.innerHTML=`<div class="icon-cell" aria-hidden="true"></div>
          <div class="meta">
            <div class="item-title">${g.title}</div>
            <div class="item-desc">${g.desc}</div>
          </div>
          <div class="item-play"><a class="btn" href="${g.href}" data-id="${g.id}">Играть</a></div>`;
        f.appendChild(el);
      });
      gamesEl.appendChild(f);
    })();
    // ——— Кастомная прокрутка (тач/колесо/ползунок) ———
    (function(){
      const wrap=gamesEl; let scroll=0; const line=36;
      function clamp(v,min,max){return v<min?min:v>max?max:v}
      function contentH(){return Array.from(wrap.children).reduce((h,el)=>h+el.offsetHeight,0)}
      function vp(){return wrap.clientHeight}
      function maxS(){return Math.max(0,contentH()-vp())}
      function apply(){
        wrap.style.transform=`translateY(${-scroll|0}px)`;
        const h=vp(), total=contentH(), ratio=h/Math.max(h,total);
        const trackH=bar.clientHeight, th=Math.max(40,(trackH*ratio)|0);
        const y=(maxS()?(scroll/maxS()):0)*(trackH-th);
        thumb.style.height=`${th}px`; thumb.style.top=`${y|0}px`;
      }
      function onWheel(e){e.preventDefault(); scroll=clamp(scroll+(e.deltaY>0?line:-line),0,maxS()); apply()}
      function onTouchStart(e){
        let sy=e.touches[0].clientY, base=scroll;
        function mv(ev){const y=ev.touches[0].clientY; scroll=clamp(base+(sy-y),0,maxS()); apply()}
        function ed(){document.removeEventListener("touchmove",mv); document.removeEventListener("touchend",ed)}
        document.addEventListener("touchmove",mv,{passive:false}); document.addEventListener("touchend",ed,{passive:true})
      }
      wrap.addEventListener("wheel",onWheel,{passive:false});
      wrap.addEventListener("touchstart",onTouchStart,{passive:false});
      (function(){let sy=0,base=0;
        function mv(e){const dy=(e.clientY-sy), track=(bar.clientHeight-thumb.clientHeight), ratio=maxS()/Math.max(1,track);
          scroll=clamp(base+dy*ratio,0,maxS()); apply()}
        function up(){document.removeEventListener("mousemove",mv); document.removeEventListener("mouseup",up); thumb.style.cursor="grab"}
        thumb.addEventListener("mousedown",e=>{sy=e.clientY;base=scroll; document.addEventListener("mousemove",mv); document.addEventListener("mouseup",up); thumb.style.cursor="grabbing"})
      })();
      addEventListener("resize",()=>apply()); requestAnimationFrame(apply);
    })();
    // ——— Fullscreen toggle ———
    document.getElementById("btn-full").addEventListener("click",async()=>{
      const el=document.documentElement;
      try{ if(!document.fullscreenElement){await el.requestFullscreen()} else {await document.exitFullscreen()} }catch(e){}
    });
    // ——— Settings (заглушка, иконка-шестерня уже пиксельная) ———
    document.getElementById("btn-settings").addEventListener("click",()=>{alert("Настройки: тема/масштаб/звук — скоро.")});
    // ——— Мобилки: убираем резиновый скролл страницы ———
    document.addEventListener("touchmove",e=>{e.preventDefault()},{passive:false});
    // Принципиально: FPS/версию не считаем и не показываем.
  </script>
</body>
</html>
